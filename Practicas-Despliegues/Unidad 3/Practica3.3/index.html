
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://mydomain.org/mysite/Practicas-Despliegues/Unidad%203/Practica3.3/">
      
      
        <link rel="prev" href="../Practica3.2/">
      
      
        <link rel="next" href="../Practica3.4-Ampliacion/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Práctica 3.3: Despliegue de una aplicación Flask (Python) - Prácticas Despliegue Aplicaciones web</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="deep-purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#practica-33-despliegue-de-una-aplicacion-flask-python" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Prácticas Despliegue Aplicaciones web" class="md-header__button md-logo" aria-label="Prácticas Despliegue Aplicaciones web" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Prácticas Despliegue Aplicaciones web
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Práctica 3.3: Despliegue de una aplicación Flask (Python)
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="deep-purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="white"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Prácticas Despliegue Aplicaciones web" class="md-nav__button md-logo" aria-label="Prácticas Despliegue Aplicaciones web" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Prácticas Despliegue Aplicaciones web
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ¡Bienvenido al Repositorio de Prácticas de Despliegue de Aplicaciones Web! 🎉
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Practicas Despliegues
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Practicas Despliegues
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Unidad 2
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Unidad 2
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%202/Practica2.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Práctica 2.1 - Instalación y configuración de un servidor web Nginx
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%202/Practica2.2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Práctica 2.2 – Autenticación en Nginx
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%202/Practica2.3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Práctica 2.3 – Proxy inverso con Nginx
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%202/Practica2.4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Práctica 2.4 – Balanceo de carga con proxy inverso en Nginx
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%202/Practica2.5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Práctica 2.5 - Proxy Inverso y balanceo de carga con SSL en NGINX
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Unidad 3
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Unidad 3
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Practica3.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Práctica 3.1: Instalación de Tomcat y despliegue con Maven
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Practica3.2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Práctica 3.2: Despliegue de aplicaciones con Node Express y Despliegue de una aplicación React en Netlify (PaaS)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Práctica 3.3: Despliegue de una aplicación Flask (Python)
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Práctica 3.3: Despliegue de una aplicación Flask (Python)
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerrequisitos" class="md-nav__link">
    <span class="md-ellipsis">
      Prerrequisitos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduccion" class="md-nav__link">
    <span class="md-ellipsis">
      Introducción
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Introducción">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#que-es-un-framework" class="md-nav__link">
    <span class="md-ellipsis">
      ¿Qué es un framework?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flask" class="md-nav__link">
    <span class="md-ellipsis">
      Flask
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gunicorn" class="md-nav__link">
    <span class="md-ellipsis">
      Gunicorn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gestor-de-paquetes-pip" class="md-nav__link">
    <span class="md-ellipsis">
      Gestor de Paquetes PIP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#entornos-virtuales-en-python" class="md-nav__link">
    <span class="md-ellipsis">
      Entornos virtuales en Python
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pipenv" class="md-nav__link">
    <span class="md-ellipsis">
      Pipenv
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#despliegue" class="md-nav__link">
    <span class="md-ellipsis">
      Despliegue
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ejercicio-1" class="md-nav__link">
    <span class="md-ellipsis">
      Ejercicio 1
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Practica3.4-Ampliacion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Práctica de Ampliación
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Unidad 4
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Unidad 4
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%204/Practica4.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Práctica 4.1 - Configuración de un servidor DNS
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Unidad 5
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Unidad 5
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%205/Practica5.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Práctica 5.1 - Ejercicios de Git y Github
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Unidad 6
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            Unidad 6
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%206/Practica6.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Práctica 6.1 - Dockerización del despliegue de una aplicación Node.js
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%206/Practica6.2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Práctica 6.2 - Despliegue de una aplicación PHP con Nginx y MySQL usando Docker y docker-compose
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%206/Practica6.3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Práctica 6.3 - Despliegue de servidores web con usuarios autenticados mediante LDAP usando Docker y docker-compose
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Proyecto Fct
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Proyecto Fct
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Proyecto-Fct/Decripcion-Proyecto/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1. Implementación del proyecto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Proyecto-Fct/Endpoints-Api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2. EndPoints Api
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="practica-33-despliegue-de-una-aplicacion-flask-python">Práctica 3.3: Despliegue de una aplicación Flask (Python)</h1>
<h2 id="prerrequisitos">Prerrequisitos</h2>
<p>Servidor Debian con los siguientes paquetes instalados:</p>
<ul>
<li>Nginx</li>
<li>Gunicorn</li>
<li>Pipenv</li>
</ul>
<h2 id="introduccion">Introducción</h2>
<h3 id="que-es-un-framework">¿Qué es un framework?</h3>
<p>Actualmente, en el desarrollo moderno de aplicaciones web se utilizan distintos Frameworks que son herramientas que nos dan un esquema de trabajo y una serie de utilidades y funciones que nos facilita y nos abstrae de la construcción de páginas web dinámicas.</p>
<p>En general los Frameworks están asociados a lenguajes de programación (Ruby on Rails (Ruby), Symphony (PHP)), en el mundo de Python el más conocido es Django, pero Flask es una opción que quizás no tenga una curva de aprendizaje tan elevada, pero nos posibilita la creación de aplicaciones web igual de complejas de las que se pueden crear en Django.</p>
<h3 id="flask">Flask</h3>
<p>En la actualidad existen muchas opciones para crear páginas web y muchos lenguajes (PHP, JAVA), y en este caso Flask nos permite crear de una manera muy sencilla aplicaciones web con Python.</p>
<p>Flask es un “micro” Framework escrito en Python y concebido para facilitar el desarrollo de Aplicaciones Web bajo el patrón MVC.</p>
<p>La palabra “micro” no designa a que sea un proyecto pequeño o que nos permita hacer páginas web pequeñas, sino que al instalar Flask tenemos las herramientas necesarias para crear una aplicación web funcional, pero si se necesita en algún momento una nueva funcionalidad hay un conjunto muy grande extensiones (plugins) que se pueden instalar con Flask que le van dotando de funcionalidad.</p>
<p><img alt="Flask" src="../../../assets/images/Practica3.3/flask.jpg" /></p>
<h3 id="gunicorn">Gunicorn</h3>
<p>Cuando se implementa una aplicación web basada en Python, normalmente se tienen estas tres piezas:</p>
<ul>
<li>Servidor web (Nginx, Apache)</li>
<li>Servidor de aplicaciones WSGI (Gunicorn, uWSGI, mod_wsgi, Waitress)</li>
<li>Aplicación web (Django, Flask, Pyramid, FastAPI)</li>
</ul>
<p>Los servidores web procesan y distribuyen las solicitudes de los navegadores y otros clientes y envían respuestas a los mismos.</p>
<p>WSGI (Web Server Gateway Interface) proporciona un conjunto de reglas para estandarizar el comportamiento y la comunicación entre servidores web y aplicaciones web. Mediante el uso de servidores y aplicaciones web compatibles con WSGI, los desarrolladores pueden concentrar su tiempo y energía en el desarrollo de aplicaciones web en lugar de administrar la comunicación entre la aplicación y el servidor web.</p>
<h3 id="gestor-de-paquetes-pip">Gestor de Paquetes PIP</h3>
<p><code>pip</code> es el comando para instalar paquetes de Python integrados en las fuentes desde la versión 3.4.</p>
<p>Este comando automatiza la conexión al sitio https://pypi.org/, la descarga, la instalación e incluso la compilación del módulo solicitado.</p>
<p>Además, se ocupa de las dependencias de cada paquete.</p>
<h3 id="entornos-virtuales-en-python">Entornos virtuales en Python</h3>
<p>Un entorno virtual es una forma de tener múltiples instancias paralelas del intérprete de Python, cada una con diferentes conjuntos de paquetes y diferentes configuraciones. Cada entorno virtual contiene una copia independiente del intérprete de Python, incluyendo copias de sus utilidades de soporte.</p>
<h3 id="pipenv">Pipenv</h3>
<p><code>Pipenv</code> es una herramienta que apunta a traer todo lo mejor del mundo de empaquetado (bundler, composer, npm, cargo, yarn, etc.) al mundo de Python.</p>
<p>Automáticamente, crea y maneja un entorno virtual para tus proyectos, también permite agregar/eliminar paquetes desde tu Pipfile así como instalar/desinstalar paquetes. También genera lo más importante, el archivo Pipfile.lock, que es usado para producir determinado build.</p>
<h2 id="despliegue">Despliegue</h2>
<ol>
<li>
<p>Instalamos el gestor de paquetes de Python Pip:</p>
<div class="language-text highlight"><pre><span></span><code><span id="True-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>sudo apt update
</span><span id="True-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="True-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>sudo apt install python3-pip
</span></code></pre></div>
</li>
<li>
<p>Instalamos el paquete pipenv para gestionar entornos virtuales:</p>
<div class="language-text highlight"><pre><span></span><code><span id="True-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>sudo apt install pipenv
</span></code></pre></div>
</li>
<li>
<p>Comprobamos que está instalado correctamente mostrando su versión:</p>
<div class="language-text highlight"><pre><span></span><code><span id="True-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>pipenv --version
</span></code></pre></div>
<p><img alt="Version PIP" src="../../../assets/images/Practica3.3/version-pip.png" /></p>
</li>
<li>
<p>Creamos el directorio en el que almacenaremos nuestro proyecto:</p>
<div class="language-text highlight"><pre><span></span><code><span id="True-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>sudo mkdir /var/www/proyecto-flask1
</span></code></pre></div>
</li>
<li>
<p>Al crearlo con SUDO, los permisos pertenecen a root:</p>
<p><img alt="ls -l /var/www" src="../../../assets/images/Practica3.3/ls-var-www.png" /></p>
</li>
<li>
<p>Hay que cambiarlo para que el dueño sea nuestro usuario y pertenezca al grupo www-data, el usuario
usado por defecto por el servidor web:</p>
<div class="language-text highlight"><pre><span></span><code><span id="True-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>sudo chown -R $USER:www-data /var/www/proyecto-flask1
</span></code></pre></div>
</li>
<li>
<p>Establecemos los permisos adecuados al directorio, para que pueda ser leído por todo el mundo::</p>
<div class="language-text highlight"><pre><span></span><code><span id="True-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>chmod -R 775 /var/www/proyecto-flask1
</span></code></pre></div>
</li>
<li>
<p>Dentro del directorio de nuestra aplicación, creamos un archivo oculto .env que contendrá las variables de entorno necesarias:</p>
<div class="language-text highlight"><pre><span></span><code><span id="True-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>touch .env
</span></code></pre></div>
</li>
<li>
<p>Editamos el archivo y añadimos las variables, indicando cuál es el archivo .py de la aplicación y el entorno, que en nuestro caso
será producción:</p>
<div class="language-text highlight"><pre><span></span><code><span id="True-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>FLASK_APP = wsgi.py
</span><span id="True-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>FLASK_ENV = production
</span></code></pre></div>
<p><img alt="cat env" src="../../../assets/images/Practica3.3/cat.env.png" /></p>
</li>
<li>
<p>Iniciamos ahora nuestro entorno virtual. <code>Pipenv</code> cargará las variables de entorno desde el fichero .env de forma automática:</p>
<div class="language-text highlight"><pre><span></span><code><span id="True-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>pipenv shell
</span></code></pre></div>
<p><img alt="resultado-pipenvshell" src="../../../assets/images/Practica3.3/pipenv-shell.png" /></p>
</li>
<li>
<p>Usamos pipenv para instalar las dependencias necesarias para nuestro proyecto:</p>
<div class="language-text highlight"><pre><span></span><code><span id="True-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>pipenv install flask gunicorn
</span></code></pre></div>
<p><img alt="Instalación de unicorn y flask" src="../../../assets/images/Practica3.3/Instalacion-unicorn-flask.png" /></p>
</li>
<li>
<p>Vamos ahora a crear la aplicación Flask más simple posible, a modo de prueba. El archivo que contendrá la aplicación
propiamente dicha será <code>application.py</code> y <code>wsgi.py</code> se encargará únicamente de iniciarla y dejarla corriendo:</p>
<div class="language-text highlight"><pre><span></span><code><span id="True-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>touch application.py wsgi.py
</span></code></pre></div>
<p>Y tras crear los archivos, los editamos para dejarlos así:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">application.py</label><label for="__tabbed_1_2">wsgi.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-python highlight"><pre><span></span><code><span id="True-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Flask</span>
</span><span id="True-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>
</span><span id="True-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="True-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>
</span><span id="True-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
</span><span id="True-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="k">def</span><span class="w"> </span><span class="nf">index</span><span class="p">():</span>
</span><span id="True-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Index page route&#39;&#39;&#39;</span>
</span><span id="True-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>
</span><span id="True-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>    <span class="k">return</span> <span class="s1">&#39;&lt;h1&gt;Aplicación desplegada&lt;/h1&gt;&#39;</span>
</span></code></pre></div>
<p><img alt="nano application.py" src="../../../assets/images/Practica3.3/nano-application.png" /></p>
</div>
<div class="tabbed-block">
<div class="language-python highlight"><pre><span></span><code><span id="True-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">application</span><span class="w"> </span><span class="kn">import</span> <span class="n">app</span>
</span><span id="True-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>
</span><span id="True-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span><span id="True-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></code></pre></div>
<p><img alt="nano wsgi" src="../../../assets/images/Practica3.3/nano-wsgi.png" /></p>
</div>
</div>
</div>
</li>
<li>
<p>Corramos ahora nuestra aplicación a modo de comprobación con el servidor web integrado de Flask. Si especificamos 
la dirección 0.0.0.0 lo que le estamos diciendo es que escuche en todas sus interfaces, si las tuviera:</p>
<div class="language-text highlight"><pre><span></span><code><span id="True-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>flask run --host &#39;0.0.0.0&#39;
</span></code></pre></div>
<p><img alt="Primer run de Flask" src="../../../assets/images/Practica3.3/run-flask.png" /></p>
</li>
<li>
<p>Ahora podemos acceder a la aplicación desde nuestro, ordenador, introduciendo en un navegador web: <code>http://ip-maq-virtual:5000</code>:</p>
<p><img alt="Imagen navegador" src="../../../assets/images/Practica3.3/imagen-navegador.png" /></p>
</li>
</ol>
<p>Ahora comprobaremos que unicorn trabaja bien. Usaremos el siguiente comando:</p>
<div class="language-text highlight"><pre><span></span><code><span id="True-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>gunicorn --workers 4 --bind 0.0.0.0:5000 wsgi:app
</span></code></pre></div>
<p>Donde:</p>
<ul>
<li>
<p>workers N establece el número de hilos que queremos utilizar, como ocurría con Node Express. </p>
</li>
<li>
<p>bind 0.0.0.0:5000 hace que el servidor escuche peticiones por todas las interfaces de red y en el puerto 5000</p>
</li>
<li>
<p>wsgi:app es el nombre del archivo con extensión .py y app es la instancia de la aplicación Flask dentro del archivo.</p>
</li>
</ul>
<p>Y debería mostrarnos esto:</p>
<p><img alt="Gunicorn prueba" src="../../../assets/images/Practica3.3/gunicorn-prueba.png" /></p>
<ol>
<li>
<p>Dentro del entorno virtual, debemos tomar nota de cuál es el path desde la que se ejecuta gunicorn para poder configurar más adelante un servicio del sistema. Podemos averiguarlo así:</p>
<div class="language-text highlight"><pre><span></span><code><span id="True-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>which gunicorn
</span></code></pre></div>
<p><img alt="Which Gunicorn" src="../../../assets/images/Practica3.3/which-unicorn.png" /></p>
</li>
<li>
<p>Ya fuera de nuestro entorno virtual, crearemos un archivo para que systemd corra Gunicorn como un servicio del sistema más:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="True-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="o">[</span>UNIT<span class="o">]</span>
</span><span id="True-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="nv">Description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>flask_app.service
</span><span id="True-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="nv">After</span><span class="o">=</span>network.target
</span><span id="True-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>
</span><span id="True-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="o">[</span>Service<span class="o">]</span>
</span><span id="True-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="nv">User</span><span class="o">=</span>acoronado
</span><span id="True-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="nv">Group</span><span class="o">=</span>www-data
</span><span id="True-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="nv">Enviroment</span><span class="o">=</span><span class="s2">&quot;/home/acoronado/.local/share/virtualenvs/proyecto-flask1-hKRFb4qr/bin/&quot;</span>
</span><span id="True-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="nv">WorkingDirectory</span><span class="o">=</span>/var/www/proyecto-flask1
</span><span id="True-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="nv">ExecStart</span><span class="o">=</span><span class="w"> </span>/home/acoronado/.local/share/virtualenvs/proyecto-flask1-hKRFb4qr/bin/gunicorn<span class="w"> </span>--workers<span class="w"> </span><span class="m">3</span><span class="w"> </span>--bind<span class="w"> </span>unix<span class="w"> </span>/var/www/proyecto-flask1/proyecto-flask1.sock<span class="w"> </span>wsgi:app
</span><span id="True-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>
</span><span id="True-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a><span class="o">[</span>Install<span class="o">]</span>
</span><span id="True-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="nv">WantedBy</span><span class="o">=</span>multi-user.target
</span></code></pre></div>
<p><img alt="Imagen configuración servicio" src="../../../assets/images/Practica3.3/imagen-configuracion-servicio.png" /></p>
</li>
<li>
<p>Ahora, como cada vez que se crea un servicio nuevo de systemd, se habilita y se inicia</p>
<div class="language-text highlight"><pre><span></span><code><span id="True-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>systemctl enable nombre_servicio
</span><span id="True-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>
</span><span id="True-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>systemctl start nombre_servicio
</span><span id="True-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>
</span><span id="True-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>systemctl status nombre_servicio
</span></code></pre></div>
<p>Y si todo ha ido bien al ejecutar <code>systemctl status nombre_servicio</code> debería de salirnos como activo</p>
<p><img alt="Activo" src="../../../assets/images/Practica3.3/status-servicio.png" /></p>
</li>
<li>
<p>A continuación creamos un archivo con el nombre de nuestra aplicación y debe estar en <code>/etc/nginx/sites-available/nombre_aplicacion.</code></p>
<div class="language-nginx highlight"><pre><span></span><code><span id="True-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="k">server</span><span class="w"> </span><span class="p">{</span>
</span><span id="True-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="w">    </span><span class="kn">listen</span><span class="w"> </span><span class="mi">80</span><span class="p">;</span>
</span><span id="True-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="w">    </span><span class="kn">server_name</span><span class="w"> </span><span class="s">proyecto-flask1</span><span class="w"> </span><span class="s">www.proyecto-flask1</span><span class="p">;</span>
</span><span id="True-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>
</span><span id="True-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="w">    </span><span class="kn">access_log</span><span class="w"> </span><span class="s">/var/log/nginx/proyecto-flask1.access.log</span><span class="p">;</span>
</span><span id="True-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="w">    </span><span class="kn">error_log</span><span class="w"> </span><span class="s">/var/log/nginx/proyecto-flask1.error.log</span><span class="p">;</span>
</span><span id="True-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>
</span><span id="True-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
</span><span id="True-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="w">            </span><span class="kn">include</span><span class="w"> </span><span class="s">proxy_params</span><span class="p">;</span>
</span><span id="True-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a><span class="w">            </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">http://unix:/var/www/proyecto-flask1/proyecto-flask1.sock</span><span class="p">;</span>
</span><span id="True-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="w">    </span><span class="p">}</span>
</span><span id="True-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a><span class="p">}</span><span class="w">   </span>
</span></code></pre></div>
</li>
<li>
<p>Recordemos que ahora debemos crear un link simbólico del archivo de sitios webs disponibles al de sitios web activos:</p>
<div class="language-text highlight"><pre><span></span><code><span id="True-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>sudo ln -s /etc/nginx/sites-available/nombre_aplicacion /etc/nginx/sites-enabled/
</span></code></pre></div>
</li>
<li>
<p>Para finalizar reiniciaremos el servicio de nginx</p>
<div class="language-text highlight"><pre><span></span><code><span id="True-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>sudo systemctl restart nginx
</span></code></pre></div>
</li>
<li>
<p>Ya no podremos acceder por IP a nuestra aplicación, ya que ahora está siendo servida por Gunicorn y Nginx, necesitamos acceder por su server_name.
esto lo haremos modificando el archivo /etc/hosts</p>
<div class="language-text highlight"><pre><span></span><code><span id="True-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>192.168.X.X proyecto www.proyecto
</span></code></pre></div>
</li>
<li>
<p>El último paso es comprobar que todo el despliegue se ha realizado de forma correcta y está funcionando, para ello accedemos desde nuestra máquina anfitriona a:</p>
</li>
</ol>
<p><img alt="Comprobación aplicación desplegada" src="../../../assets/images/Practica3.3/Aplicaci%C3%B3nDesplegada.png" /></p>
<h2 id="ejercicio-1"><strong>Ejercicio 1</strong></h2>
<div class="admonition note">
<p class="admonition-title">Ejercicio</p>
<p>Repite todo el proceso con la aplicación del siguiente repositorio: <code>https://github.com/raul-profesor/Practica-3.5</code></p>
<p>Recuerda que deberás clonar el repositorio en tu directorio <code>/var/www</code>:</p>
<p><code>git clone https://github.com/raul-profesor/Practica-3.5</code></p>
<p>Y, tras activar el entorno virtual dentro del directorio del repositorio clonado, para instalar las dependencias del proyecto de la aplicación deberás hacer:</p>
<p><code>pipenv install -r requirements.txt</code></p>
<p>Y un último detalle, si miráis el código del proyecto, que es muy sencillo, veréis que Gunicorn debe iniciarse ahora así:</p>
<div class="language-text highlight"><pre><span></span><code><span id="True-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>gunicorn --workers 4 --bind 0.0.0.0:5000 wsgi:app
</span></code></pre></div>
<p>Y el resto sería proceder tal y como hemos hecho en esta práctica.</p>
</div>
<ol>
<li>
<p>El primer paso que haremos será clonar el repositorio <code>https://github.com/raul-profesor/Practica-3.5</code> en la ruta <code>/var/www</code> con el siguiente comando:</p>
<div class="language-text highlight"><pre><span></span><code><span id="True-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>git clone https://github.com/raul-profesor/Practica-3.5
</span></code></pre></div>
<p><img alt="Clonación repositorio app 2" src="../../../assets/images/Practica3.3/clonaci%C3%B3n-app2.png" /></p>
</li>
<li>
<p>Tras haber clonado el repositorio cambiaremos los permisos y grupos de estas carpetas para poder hacer modificaciones
en las mismas.</p>
<div class="language-text highlight"><pre><span></span><code><span id="True-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>sudo chwon -R usuario:www-data ./Practica-3.5
</span><span id="True-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>sudo chmod -R 775 ./Practica-3.5 
</span></code></pre></div>
<p>Y como podemos ver, los cambios se han aplicado correctamente</p>
<p><img alt="Permisos y usuarios" src="../../../assets/images/Practica3.3/cmabios-practica35.png" /></p>
</li>
<li>
<p>Lo siguiente que deberemos hacer será crear el archivo .env para poder ejecutar el entorno virtual de Python
en el cual escribiremos lo siguiente:</p>
<div class="language-text highlight"><pre><span></span><code><span id="True-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>FLASK_APP = wsgi.py
</span><span id="True-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>FLASK_ENV = production
</span></code></pre></div>
<p>Y ahora ejecutaremos el entorno virtual con <code>pipenv shell</code></p>
<p><img alt="Inicialización de Pipenv shell" src="../../../assets/images/Practica3.3/pipenv-shell2.png" /></p>
</li>
<li>
<p>A continuación entraremos en él con <code>cd Practica-3.5</code> y ejecutamos el siguiente comando</p>
<div class="language-text highlight"><pre><span></span><code><span id="True-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>pipenv install -r requirements.txt
</span></code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Esto instalará todos los paquetes que la aplicación python necesita para
funcionar</p>
</div>
<p><img alt="Instalación de dependencias del proyecto" src="../../../assets/images/Practica3.3/instalacion-dependencias.png" /></p>
</li>
<li>
<p>Tras que la instalación de dependencias del proyecto se descargue e instale correctamente deberemos proceder
con la instalación de gunicorn.</p>
<div class="language-text highlight"><pre><span></span><code><span id="True-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>pipenv install gunicorn
</span></code></pre></div>
</li>
<li>
<p>Antes de comenzar con la configuración de gunicorn vamos a comprobar que la página web funciona para eso
ejecutaremos el comando.</p>
<div class="language-text highlight"><pre><span></span><code><span id="True-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>flask run --host &#39;0.0.0.0&#39;
</span></code></pre></div>
<p>Y como podemos ver, la página web se muestra correctamente</p>
<p><img alt="Prueba para ver si página web se muestra" src="../../../assets/images/Practica3.3/welcome-azure.png" /></p>
</li>
</ol>
<p>Una vez que sabemos que la página web se muestra correctamente probaremos con gunicorn
para ver si también trabaja correctamente</p>
<div class="language-text highlight"><pre><span></span><code><span id="True-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>gunicorn --workers 4 --bind 0.0.0.0:5000 wsgi:app
</span></code></pre></div>
<p>Y nos saldría algo muy parecido a esto</p>
<p><img alt="Prueba gunicorn 2" src="../../../assets/images/Practica3.3/prueba-guinicorn2.png" /></p>
<p>Tras esto deberemos averiguar y tomar nota de cuál es el path desde el cual se ejecuta gunicorn para configurar
en unos pasos más adelante un servicio del sistema. Ejecutaremos el siguiente comando:</p>
<div class="language-text highlight"><pre><span></span><code><span id="True-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>which gunicorn
</span></code></pre></div>
<p><img alt="Ubicación gunicorn 2" src="../../../assets/images/Practica3.3/ubicacion-gunicorn2.png" /></p>
<p>/home/acoronado/.local/share/virtualenvs/Practica-3.5-fn2PEgVy/bin/gunicorn</p>
<ol>
<li>
<p>Lo siguiente que haremos será crear el archivo de configuración del servicio para que gunicorn se pueda
ejecutar como servicio en el sistema.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="True-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="o">[</span>Unit<span class="o">]</span>
</span><span id="True-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="nv">Description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>practica-3.5.service
</span><span id="True-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a><span class="nv">After</span><span class="o">=</span>network.target
</span><span id="True-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a>
</span><span id="True-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a><span class="o">[</span>Service<span class="o">]</span>
</span><span id="True-31-6"><a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a><span class="nv">User</span><span class="o">=</span>acoronado
</span><span id="True-31-7"><a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a><span class="nv">Group</span><span class="o">=</span>www-data
</span><span id="True-31-8"><a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a><span class="nv">Enviorment</span><span class="o">=</span><span class="s2">&quot;/home/acoronado/.local/share/virtualenvs/Practica-3.5-fn2PEgVy/bin/&quot;</span>
</span><span id="True-31-9"><a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a><span class="nv">WorkingDirectory</span><span class="o">=</span>/var/www/Practica-3.5
</span><span id="True-31-10"><a id="__codelineno-31-10" name="__codelineno-31-10" href="#__codelineno-31-10"></a><span class="nv">ExecStart</span><span class="o">=</span><span class="w"> </span>/home/acoronado/.local/share/virtualenvs/Practica-3.5-fn2PEgVy/bin/gunicorn<span class="w"> </span>--workers<span class="w"> </span><span class="m">4</span><span class="w"> </span>--bind<span class="w"> </span>unix:/var/www/Practica-3.5/Practica-3.5.sock<span class="w"> </span>w&gt;
</span><span id="True-31-11"><a id="__codelineno-31-11" name="__codelineno-31-11" href="#__codelineno-31-11"></a>
</span><span id="True-31-12"><a id="__codelineno-31-12" name="__codelineno-31-12" href="#__codelineno-31-12"></a><span class="o">[</span>Install<span class="o">]</span>
</span><span id="True-31-13"><a id="__codelineno-31-13" name="__codelineno-31-13" href="#__codelineno-31-13"></a><span class="nv">WantedBy</span><span class="o">=</span>multi-user.target
</span></code></pre></div>
<p>Y para que este archivo se pueda ejecutar introduciremos los siguientes comandos en la consola</p>
<div class="language-text highlight"><pre><span></span><code><span id="True-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>    sudo systemctl enable practica-3.5.service
</span><span id="True-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>    sudo systemctl start practica-3.5.service
</span></code></pre></div>
<p><img alt="activación-servicio-gunicorn2" src="../../../assets/images/Practica3.3/activacion-gunicorn2.png" /></p>
<p>Como se puede ver, el servicio está activo y corriendo</p>
<p><img alt="Verificación de estado servicio gunicorn2" src="../../../assets/images/Practica3.3/status2.png" /></p>
</li>
<li>
<p>Tras esto crearemos un archivo de configuración de nginx con el nombre de nuestra aplicación el cual estará ubicado en 
<code>/etc/nginx/sites-availabe/nombre</code></p>
<div class="language-nginx highlight"><pre><span></span><code><span id="True-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="k">server</span><span class="w"> </span><span class="p">{</span>
</span><span id="True-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="w">    </span><span class="kn">listen</span><span class="w"> </span><span class="mi">80</span><span class="p">;</span>
</span><span id="True-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a><span class="w">    </span><span class="kn">server_name</span><span class="w"> </span><span class="s">practica-3_5</span><span class="w"> </span><span class="s">www.practica-3_5</span><span class="p">;</span>
</span><span id="True-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a>
</span><span id="True-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a><span class="w">    </span><span class="kn">access_log</span><span class="w"> </span><span class="s">/var/log/nginx/practica-3.5.access.log</span><span class="p">;</span>
</span><span id="True-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a><span class="w">    </span><span class="kn">error_log</span><span class="w"> </span><span class="s">/var/log/nginx/practica-3.5.error.log</span><span class="p">;</span>
</span><span id="True-33-7"><a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a>
</span><span id="True-33-8"><a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a><span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/</span><span class="w"> </span><span class="p">{</span>
</span><span id="True-33-9"><a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a><span class="w">            </span><span class="kn">include</span><span class="w"> </span><span class="s">proxy_params</span><span class="p">;</span>
</span><span id="True-33-10"><a id="__codelineno-33-10" name="__codelineno-33-10" href="#__codelineno-33-10"></a><span class="w">            </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">http://unix:/var/www/Practica-3.5/Practica-3.5.sock</span><span class="p">;</span>
</span><span id="True-33-11"><a id="__codelineno-33-11" name="__codelineno-33-11" href="#__codelineno-33-11"></a><span class="w">    </span><span class="p">}</span>
</span><span id="True-33-12"><a id="__codelineno-33-12" name="__codelineno-33-12" href="#__codelineno-33-12"></a><span class="p">}</span>
</span></code></pre></div>
</li>
<li>
<p>Ahora deberemos crear un link simbólico del archivo de sitios webs disponibles al de sitios web activos:</p>
<div class="language-text highlight"><pre><span></span><code><span id="True-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>sudo ln -s /etc/nginx/sites-available/nombre /etc/nginx/sites-enabled/
</span></code></pre></div>
<p><img alt="Enlace simbólico practica-3.5 sites-enabled" src="../../../assets/images/Practica3.3/enlace-simbolico2.png" /></p>
</li>
<li>
<p>Por último reiniciaremos el servicio de nignx</p>
<div class="language-text highlight"><pre><span></span><code><span id="True-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>sudo systemctl restart nginx
</span></code></pre></div>
</li>
<li>
<p>Ya lo último que quedaría sería añadir el servidor a nuestra lista de hosts conocidos en nuestra máquina anfitriona
para poder visitar la web</p>
<div class="language-text highlight"><pre><span></span><code><span id="True-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>192.168.X.X practica-3_5 www.practica-3_5
</span></code></pre></div>
<p><img alt="Comprobación final pagina 2" src="../../../assets/images/Practica3.3/p%C3%A1gina2.png" /></p>
</li>
</ol>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../Practica3.2/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Práctica 3.2: Despliegue de aplicaciones con Node Express y Despliegue de una aplicación React en Netlify (PaaS)">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Práctica 3.2: Despliegue de aplicaciones con Node Express y Despliegue de una aplicación React en Netlify (PaaS)
              </div>
            </div>
          </a>
        
        
          
          <a href="../Practica3.4-Ampliacion/" class="md-footer__link md-footer__link--next" aria-label="Next: Práctica de Ampliación">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Práctica de Ampliación
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/Alexcoro13/Alexcoro13.github.io" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["toc.integrate", "navigation.footer", "content.code.copy", "palette:toggle"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>